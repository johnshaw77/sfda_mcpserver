# éŒ¯èª¤ä¿®æ­£ç¸½çµ

## å•é¡Œæè¿°

åœ¨å•Ÿå‹• MCP æœå‹™æ™‚ï¼Œæ‡‰ç”¨ç¨‹å¼åœ¨ã€Œè¨»å†Š HR å·¥å…·ã€éšæ®µå´©æ½°ã€‚

## æ ¹æœ¬åŸå› åˆ†æ

### 1. åŸ·è¡Œé †åºå•é¡Œ

- **å•é¡Œ**ï¼šåœ¨ `server.js` ä¸­ï¼Œå·¥å…·è¨»å†Šåœ¨è³‡æ–™åº«åˆå§‹åŒ–ä¹‹å‰åŸ·è¡Œ
- **çµæœ**ï¼šå·¥å…·è¨»å†Šæ™‚å¼•ç”¨äº†æœªå®šç¾©çš„ `databaseInitResults` è®Šæ•¸

### 2. å±¬æ€§åç¨±ä¸ä¸€è‡´

- **å•é¡Œ**ï¼šå·¥å…·æ¨¡çµ„ä½¿ç”¨ `moduleName` å±¬æ€§ï¼Œä½†åŸºç¤å·¥å…·é¡åˆ¥æœŸæœ› `module` å±¬æ€§
- **å½±éŸ¿çš„æ¨¡çµ„**ï¼šHRã€MILã€STAT æ‰€æœ‰å·¥å…·æ¨¡çµ„

### 3. ç«¯é»å®šç¾©é‡è¤‡

- **å•é¡Œ**ï¼š`/api/tools/health` å’Œ `/api/tools/stats` ç«¯é»å®šç¾©é‡è¤‡
- **çµæœ**ï¼šå¯èƒ½å°è‡´è·¯ç”±è¡çª

### 4. è³‡æ–™åº«ä¾è³´é…ç½®ä¸å®Œæ•´

- **å•é¡Œ**ï¼šéƒ¨åˆ† MIL å·¥å…·ç¼ºå°‘ `module` å’Œ `requiredDatabases` é…ç½®

## ä¿®æ­£æªæ–½

### 1. èª¿æ•´åŸ·è¡Œé †åº (`server.js`)

```javascript
// ä¿®æ­£å‰ï¼šå·¥å…·è¨»å†Š -> è³‡æ–™åº«åˆå§‹åŒ–
// ä¿®æ­£å¾Œï¼šè³‡æ–™åº«åˆå§‹åŒ– -> å·¥å…·è¨»å†Š

// åˆå§‹åŒ–è³‡æ–™åº«æœå‹™
let databaseInitResults = {};
try {
  databaseInitResults = await databaseService.initialize();
  // ...
} catch (error) {
  // ...
}

// è¨»å†Šæ‰€æœ‰å·¥å…·
try {
  registerAllTools();
  logger.info("å·¥å…·è¨»å†Šå®Œæˆ", {
    totalTools: getRegisteredTools().length,
    databaseStatus: databaseInitResults, // ç¾åœ¨ databaseInitResults å·²å®šç¾©
  });
} catch (error) {
  // ...
}
```

### 2. çµ±ä¸€å±¬æ€§åç¨±

ä¿®æ­£æ‰€æœ‰å·¥å…·æ¨¡çµ„çš„ `index.js` æª”æ¡ˆï¼š

**HR æ¨¡çµ„** (`src/tools/hr/index.js`)ï¼š

```javascript
// ä¿®æ­£å‰
tool.moduleName = MODULE_NAME;

// ä¿®æ­£å¾Œ
tool.module = MODULE_NAME;
```

**MIL æ¨¡çµ„** (`src/tools/mil/index.js`)ï¼š

```javascript
// ä¿®æ­£å‰
tool.moduleName = MODULE_NAME;

// ä¿®æ­£å¾Œ
tool.module = MODULE_NAME;
```

**STAT æ¨¡çµ„** (`src/tools/stat/index.js`)ï¼š

```javascript
// ä¿®æ­£å‰
tool.moduleName = MODULE_NAME;

// ä¿®æ­£å¾Œ
tool.module = MODULE_NAME;
```

### 3. ç§»é™¤é‡è¤‡ç«¯é»å®šç¾©

- ä¿ç•™åœ¨é©ç•¶ä½ç½®çš„ç«¯é»å®šç¾©
- ç§»é™¤æª”æ¡ˆæœ«å°¾é‡è¤‡çš„ç«¯é»å®šç¾©

### 4. å®Œå–„ MIL å·¥å…·é…ç½®

ç‚ºæ‰€æœ‰ MIL å·¥å…·æ·»åŠ å®Œæ•´çš„é…ç½®ï¼š

```javascript
{
  cacheable: true,
  cacheExpiry: 60 * 5,
  module: "mil",
  requiredDatabases: ["mil"],
}
```

**ä¿®æ­£çš„æª”æ¡ˆ**ï¼š

- `get-mil-details.js`
- `get-mil-type-list.js`
- `get-status-report.js`
- `get-count-by.js`

## é©—è­‰çµæœ

### ä¿®æ­£å‰ç—‡ç‹€

```
[nodemon] starting `node src/server.js`
âœ… SQLite æ—¥èªŒè³‡æ–™åº«å·²åˆå§‹åŒ–
ğŸ“ æ—¥èªŒç³»çµ±å·²å®Œå…¨åˆå§‹åŒ–
è¨»å†Š HR å·¥å…·...
[nodemon] app crashed - waiting for file changes before starting...
```

### ä¿®æ­£å¾Œé æœŸçµæœ

- âœ… è³‡æ–™åº«æœå‹™æ­£ç¢ºåˆå§‹åŒ–
- âœ… å·¥å…·è¨»å†ŠæˆåŠŸå®Œæˆ
- âœ… ä¼ºæœå™¨æ­£å¸¸å•Ÿå‹•
- âœ… å®¹éŒ¯æ©Ÿåˆ¶æ­£å¸¸é‹ä½œ

## å—ç›Šæ•ˆæœ

1. **ç³»çµ±ç©©å®šæ€§**ï¼šæ¶ˆé™¤å•Ÿå‹•éšæ®µçš„å´©æ½°å•é¡Œ
2. **é…ç½®ä¸€è‡´æ€§**ï¼šæ‰€æœ‰å·¥å…·æ¨¡çµ„ä½¿ç”¨çµ±ä¸€çš„å±¬æ€§å‘½å
3. **å®¹éŒ¯èƒ½åŠ›**ï¼šå³ä½¿è³‡æ–™åº«é€£æ¥å¤±æ•—ï¼Œç³»çµ±ä»èƒ½å•Ÿå‹•
4. **ç›£æ§å®Œæ•´æ€§**ï¼šå¥åº·æª¢æŸ¥ç«¯é»æ­£å¸¸å·¥ä½œ

## æ¸¬è©¦å»ºè­°

1. **æ­£å¸¸å•Ÿå‹•æ¸¬è©¦**ï¼šç¢ºèªç³»çµ±èƒ½æ­£å¸¸å•Ÿå‹•
2. **è³‡æ–™åº«æ•…éšœæ¸¬è©¦**ï¼šæ¨¡æ“¬è³‡æ–™åº«é€£æ¥å¤±æ•—ï¼Œé©—è­‰å®¹éŒ¯æ©Ÿåˆ¶
3. **å·¥å…·å¯ç”¨æ€§æ¸¬è©¦**ï¼šæª¢æŸ¥ `/api/tools/health` ç«¯é»
4. **æ¨¡çµ„å·¥å…·æ¸¬è©¦**ï¼šé©—è­‰ HR å’Œ MIL å·¥å…·èƒ½æ­£å¸¸åŸ·è¡Œ

ç¾åœ¨ç³»çµ±æ‡‰è©²èƒ½å¤ æ­£å¸¸å•Ÿå‹•ä¸¦é‹è¡Œäº†ï¼
