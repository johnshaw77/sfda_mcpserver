# ANOVA 分析工具測試案例

## 工具概述

ANOVA（變異數分析）用於比較三個或以上群組的平均數是否有顯著差異，是 t 檢定的擴展應用。

## 統計專業情境

### 情境 1: 藥物劑量效應研究（單因子 ANOVA）

**研究背景**: 比較不同劑量降血壓藥物的療效
**研究設計**: 完全隨機設計，四個劑量組（安慰劑、低劑量、中劑量、高劑量）
**假設**: H₀: μ₁ = μ₂ = μ₃ = μ₄ vs H₁: 至少有一組不等CCCCC
**測試數據**:

```json
{
  "groups": [
    [142, 145, 148, 144, 147, 149, 143, 146, 150, 145],
    [138, 141, 135, 139, 137, 140, 136, 142, 134, 138],
    [128, 131, 125, 129, 127, 132, 126, 130, 124, 128],
    [118, 121, 115, 119, 117, 122, 116, 120, 114, 118]
  ],
  "group_labels": ["安慰劑", "低劑量", "中劑量", "高劑量"],
  "alpha": 0.05,
  "context": {
    "scenario": "medical",
    "variable_name": "收縮壓降幅 (mmHg)",
    "factor_name": "藥物劑量"
  }
}
```

### 情境 2: 教學方法效果比較

**研究背景**: 比較四種不同教學方法對學習成效的影響
**研究設計**: 隨機分組設計
**假設**: H₀: μ₁ = μ₂ = μ₃ = μ₄ vs H₁: 至少有一組不等

**測試數據**:

```json
{
  "groups": [
    [78, 82, 76, 80, 79, 83, 77, 81, 75, 84, 78, 80],
    [85, 89, 83, 87, 86, 90, 84, 88, 82, 91, 85, 87],
    [92, 96, 90, 94, 93, 97, 91, 95, 89, 98, 92, 94],
    [88, 92, 86, 90, 89, 93, 87, 91, 85, 94, 88, 90]
  ],
  "group_labels": ["講述法", "討論法", "實驗法", "專題法"],
  "alpha": 0.05,
  "context": {
    "scenario": "education",
    "variable_name": "期末考成績",
    "factor_name": "教學方法"
  }
}
```

## 一般用戶情境

### 情境 1: 四家分店銷售業績比較

**生活情境**: 連鎖餐廳老闆想知道四家分店的月營業額是否有差異
**數據**: 四家分店各 10 個月的營業額記錄

**測試數據**:

```json
{
  "groups": [
    [280, 295, 275, 288, 292, 285, 278, 290, 283, 287],
    [320, 335, 315, 328, 332, 325, 318, 330, 323, 327],
    [250, 265, 245, 258, 262, 255, 248, 260, 253, 257],
    [300, 315, 295, 308, 312, 305, 298, 310, 303, 307]
  ],
  "group_labels": ["信義店", "西門店", "士林店", "板橋店"],
  "alpha": 0.05,
  "context": {
    "scenario": "general",
    "variable_name": "月營業額 (萬元)",
    "factor_name": "分店位置"
  }
}
```

### 情境 2: 四個品牌手機電池續航力比較

**生活情境**: 想知道市面上四個品牌手機的電池續航力是否有差異
**數據**: 每個品牌測試 8 支手機的電池使用時間

**測試數據**:

```json
{
  "groups": [
    [12.5, 13.2, 11.8, 12.9, 13.1, 12.3, 11.9, 12.7],
    [14.2, 15.1, 13.7, 14.6, 14.8, 14.0, 13.9, 14.5],
    [11.8, 12.5, 11.2, 11.9, 12.3, 11.6, 11.4, 12.1],
    [13.5, 14.2, 12.9, 13.8, 14.0, 13.3, 13.1, 13.7]
  ],
  "group_labels": ["品牌A", "品牌B", "品牌C", "品牌D"],
  "alpha": 0.05,
  "context": {
    "scenario": "general",
    "variable_name": "電池續航力 (小時)",
    "factor_name": "手機品牌"
  }
}
```

## 重複測量 ANOVA 情境

### 情境 3: 治療時間點效果（統計專業）

**研究背景**: 評估治療在不同時間點的效果
**研究設計**: 重複測量設計，同一組患者在四個時間點測量

**測試數據**:

```json
{
  "groups": [
    [45, 42, 48, 44, 46, 43, 47, 45, 49, 41],
    [38, 35, 41, 37, 39, 36, 40, 38, 42, 34],
    [32, 29, 35, 31, 33, 30, 34, 32, 36, 28],
    [28, 25, 31, 27, 29, 26, 30, 28, 32, 24]
  ],
  "group_labels": ["基線", "1個月", "3個月", "6個月"],
  "repeated_measures": true,
  "alpha": 0.05,
  "context": {
    "scenario": "medical",
    "variable_name": "疼痛指數",
    "factor_name": "治療時間"
  }
}
```

### 情境 4: 學習進度追蹤（一般用戶）

**生活情境**: 追蹤學生在一學期中四次考試的成績變化
**數據**: 同一組學生四次考試成績

**測試數據**:

```json
{
  "groups": [
    [65, 68, 62, 67, 69, 64, 66, 63, 70, 61],
    [72, 75, 69, 74, 76, 71, 73, 70, 77, 68],
    [78, 81, 75, 80, 82, 77, 79, 76, 83, 74],
    [84, 87, 81, 86, 88, 83, 85, 82, 89, 80]
  ],
  "group_labels": ["第一次考試", "第二次考試", "第三次考試", "期末考試"],
  "repeated_measures": true,
  "alpha": 0.05,
  "context": {
    "scenario": "education",
    "variable_name": "考試成績",
    "factor_name": "考試時間"
  }
}
```

## 預期結果

### 統計專業用戶期望看到：

- F 統計量、自由度、p 值
- 效果量（η² 或 ω²）
- 事後比較（Post-hoc tests）結果
- 假設檢定的詳細步驟
- 殘差分析和假設檢驗
- 統計功效分析

### 一般用戶期望看到：

- 簡潔的結論（群組間是否有差異）
- 哪些群組彼此不同
- 視覺化比較圖表
- 實用的建議和解釋
- 差異的實際意義

## 測試指令範例

```bash
# 基本 ANOVA
curl -X POST http://localhost:3000/tools/stat/perform-anova \
  -H "Content-Type: application/json" \
  -d '{
    "groups": [[78,82,76], [85,89,83], [92,96,90]],
    "group_labels": ["組1", "組2", "組3"]
  }'

# 重複測量 ANOVA
curl -X POST http://localhost:3000/tools/stat/perform-anova \
  -H "Content-Type: application/json" \
  -d '{
    "groups": [[65,68,62], [72,75,69], [78,81,75]],
    "repeated_measures": true
  }'
```

## AI 提問範例

### 範例 1: 藥物劑量效果研究
**用戶提問**: "我在研究不同劑量的止痛藥效果。我有四組病患的疼痛緩解分數：安慰劑組 [3.2, 3.8, 3.1, 3.5, 3.4, 3.6, 3.3]，低劑量組 [5.1, 5.8, 5.2, 5.6, 5.4, 5.7, 5.3]，中劑量組 [7.2, 7.9, 7.1, 7.6, 7.4, 7.8, 7.3]，高劑量組 [8.5, 9.2, 8.3, 8.8, 8.6, 9.0, 8.7]。如何分析不同劑量是否有不同效果？"

**AI 回應**: 您想比較四個不同劑量群組的治療效果，這是典型的單因子 ANOVA 分析情境。ANOVA 可以同時比較多個群組的平均值，並告訴我們是否至少有一組與其他組有顯著差異。

**工具調用**:
```json
{
  "tool": "perform_anova",
  "data": {
    "groups": [
      [3.2, 3.8, 3.1, 3.5, 3.4, 3.6, 3.3],
      [5.1, 5.8, 5.2, 5.6, 5.4, 5.7, 5.3],
      [7.2, 7.9, 7.1, 7.6, 7.4, 7.8, 7.3],
      [8.5, 9.2, 8.3, 8.8, 8.6, 9.0, 8.7]
    ],
    "alpha": 0.05
  },
  "context": {
    "scenario": "medical",
    "description": "比較不同劑量止痛藥的治療效果",
    "group_names": ["安慰劑組", "低劑量組", "中劑量組", "高劑量組"],
    "factor_name": "藥物劑量"
  },
  "visualizations": {
    "include_charts": true,
    "chart_types": ["boxplot", "histogram", "residual_plot"],
    "generate_image": true,
    "image_format": "png"
  }
}
```

### 範例 2: 教學方法效果比較
**用戶提問**: "我是教育研究者，想比較三種不同教學方法對學生數學成績的影響。傳統講授法: [72, 75, 68, 78, 74, 71, 76, 73]，互動討論法: [81, 85, 79, 88, 83, 80, 86, 82]，專案學習法: [78, 82, 76, 85, 80, 77, 83, 79]。這三種方法的效果有差異嗎？"

**AI 回應**: 您想比較三種教學方法的效果差異，這需要使用單因子 ANOVA 分析。ANOVA 可以告訴我們三種教學方法是否在統計上有顯著差異，如果有差異，我們還可以進一步分析哪些方法之間存在差異。

**工具調用**:
```json
{
  "tool": "perform_anova",
  "data": {
    "groups": [
      [72, 75, 68, 78, 74, 71, 76, 73],
      [81, 85, 79, 88, 83, 80, 86, 82],
      [78, 82, 76, 85, 80, 77, 83, 79]
    ],
    "alpha": 0.05
  },
  "context": {
    "scenario": "education",
    "description": "比較三種教學方法對學生數學成績的影響",
    "group_names": ["傳統講授法", "互動討論法", "專案學習法"],
    "factor_name": "教學方法"
  },
  "visualizations": {
    "include_charts": true,
    "chart_types": ["boxplot", "residual_plot"],
    "generate_image": true,
    "image_format": "png"
  }
}
```

## 假設檢驗條件

- 各組資料需符合常態分佈
- 各組變異數需相等（齊質性）
- 觀察值需獨立
- 重複測量需考慮球形性假設
