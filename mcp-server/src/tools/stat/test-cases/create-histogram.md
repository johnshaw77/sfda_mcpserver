# 直方圖創建工具測試案例

## 工具概述
直方圖是用於顯示連續型資料分佈的視覺化工具，能夠展現資料的分佈形狀、中心趨勢、變異程度和異常值。

## 統計專業情境

### 情境 1: 臨床試驗血壓分佈分析
**研究背景**: 分析臨床試驗中患者的基線血壓分佈，評估常態性
**研究目的**: 檢查資料分佈以決定後續統計方法選擇
**統計意義**: 評估分佈偏態、峰度，檢驗常態性假設

**測試數據**:
```json
{
  "values": [
    128, 135, 142, 118, 156, 132, 149, 125, 163, 139, 
    145, 122, 158, 134, 151, 127, 164, 141, 147, 124,
    159, 136, 152, 129, 165, 143, 148, 126, 161, 138,
    154, 131, 167, 144, 150, 123, 162, 140, 146, 133,
    157, 137, 153, 130, 166, 142, 149, 128, 160, 135
  ],
  "bins": 12,
  "title": "基線收縮壓分佈圖",
  "x_axis_label": "收縮壓 (mmHg)",
  "y_axis_label": "頻率",
  "generate_image": true,
  "context": {
    "scenario": "medical",
    "variable_name": "基線收縮壓",
    "analysis_purpose": "常態性檢驗與分佈型態分析"
  }
}
```

### 情境 2: 教育研究成績分佈分析
**研究背景**: 分析大型考試成績分佈，檢查是否符合預期的常態分佈
**研究目的**: 評估考試難度適當性與成績分佈合理性
**統計意義**: 偏態分析、標準化分數計算參考

**測試數據**:
```json
{
  "values": [
    45, 52, 68, 73, 81, 59, 76, 63, 88, 71, 84, 67, 79, 56, 92,
    74, 61, 85, 69, 78, 54, 89, 72, 83, 66, 77, 58, 91, 75, 82,
    64, 87, 70, 80, 57, 93, 76, 62, 86, 68, 81, 55, 90, 73, 84,
    65, 88, 71, 79, 60, 94, 77, 63, 85, 69, 82, 56, 89, 74, 83
  ],
  "bins": 15,
  "title": "大學入學考試數學成績分佈",
  "x_axis_label": "數學成績",
  "y_axis_label": "學生人數",
  "generate_image": true,
  "context": {
    "scenario": "education",
    "variable_name": "考試成績",
    "analysis_purpose": "分佈型態與考試難度評估"
  }
}
```

### 情境 3: 品質管制過程分析
**研究背景**: 分析製程中產品重量的分佈，監控製程穩定性
**研究目的**: 檢查製程是否在控制範圍內，識別異常批次
**統計意義**: 製程能力分析、規格限制評估

**測試數據**:
```json
{
  "values": [
    99.2, 100.1, 98.8, 101.3, 99.7, 100.5, 98.9, 101.1, 99.4, 100.8,
    99.1, 100.2, 98.7, 101.4, 99.6, 100.7, 99.0, 101.0, 99.3, 100.9,
    98.6, 101.5, 99.8, 100.4, 98.5, 101.2, 99.5, 100.6, 98.4, 101.3,
    99.9, 100.3, 98.3, 101.6, 99.2, 100.1, 98.8, 101.1, 99.7, 100.5
  ],
  "bins": 10,
  "title": "產品重量分佈圖 (目標值: 100g)",
  "x_axis_label": "重量 (g)",
  "y_axis_label": "頻率",
  "generate_image": true,
  "context": {
    "scenario": "quality",
    "variable_name": "產品重量",
    "analysis_purpose": "製程能力與規格符合性分析"
  }
}
```

### 情境 4: 軟板製造厚度分析 - 製程控制
**研究背景**: 分析軟板製造過程中基材厚度的分佈狀況
**研究目的**: 評估製程穩定性，確保厚度符合客戶規格要求
**統計意義**: 製程能力指標計算、規格符合率評估、製程改善方向

**測試數據**:
```json
{
  "values": [
    0.048, 0.052, 0.049, 0.051, 0.050, 0.047, 0.053, 0.048, 0.051, 0.049, 
    0.052, 0.048, 0.050, 0.049, 0.051, 0.047, 0.054, 0.048, 0.052, 0.049,
    0.051, 0.048, 0.050, 0.049, 0.052, 0.047, 0.053, 0.048, 0.051, 0.049,
    0.050, 0.048, 0.052, 0.049, 0.051, 0.047, 0.053, 0.048, 0.050, 0.049,
    0.051, 0.048, 0.052, 0.049, 0.050, 0.047, 0.054, 0.048, 0.051, 0.049,
    0.045, 0.046, 0.055, 0.056, 0.044, 0.057, 0.043, 0.058, 0.042, 0.059
  ],
  "bins": 12,
  "title": "軟板基材厚度分佈分析",
  "x_axis_label": "基材厚度 (mm)",
  "y_axis_label": "產品數量",
  "generate_image": true,
  "show_statistics": true,
  "spec_limits": [0.045, 0.055],
  "context": {
    "scenario": "manufacturing",
    "variable_name": "軟板基材厚度",
    "distribution_type": "process_control",
    "analysis_purpose": "製程能力評估與厚度控制",
    "industry": "軟板製造業"
  }
}
```

### 情境 5: 軟板製造阻抗值分佈 - 電性特性分析
**研究背景**: 分析軟板電路阻抗值的分佈特性
**研究目的**: 驗證電路設計參數，確保電性能符合設計要求
**統計意義**: 電性參數分佈分析、設計驗證、製程優化指標

**測試數據**:
```json
{
  "values": [
    48.2, 51.8, 49.7, 50.3, 50.0, 47.9, 52.1, 48.8, 50.9, 49.1,
    51.2, 48.6, 50.4, 49.6, 50.8, 48.4, 51.6, 49.2, 50.7, 49.3,
    51.1, 48.9, 50.5, 49.5, 51.3, 48.7, 51.9, 49.8, 50.2, 49.4,
    50.6, 49.0, 51.0, 49.9, 50.1, 48.3, 51.7, 49.1, 50.9, 49.7,
    50.3, 48.5, 51.5, 49.3, 50.7, 48.1, 52.3, 49.6, 50.4, 49.8,
    45.2, 46.8, 53.7, 54.9, 44.1, 55.8, 43.3, 56.4, 42.7, 57.1
  ],
  "bins": 15,
  "title": "軟板電路阻抗值分佈分析",
  "x_axis_label": "阻抗值 (Ω)",
  "y_axis_label": "測試點數量",
  "generate_image": true,
  "show_statistics": true,
  "spec_limits": [45.0, 55.0],
  "context": {
    "scenario": "manufacturing",
    "variable_name": "電路阻抗值",
    "distribution_type": "electrical_parameter",
    "analysis_purpose": "電性參數驗證與製程優化",
    "industry": "軟板製造業",
    "parameter_type": "阻抗特性"
  }
}
```

## 一般用戶情境

### 情境 1: 員工薪資分佈分析
**生活情境**: 人資部門想了解公司員工薪資分佈狀況
**數據**: 公司員工月薪資料（已去識別化）
**目的**: 了解薪資結構是否合理，是否有明顯的薪資差距

**測試數據**:
```json
{
  "values": [
    35000, 42000, 38000, 55000, 41000, 48000, 36000, 62000, 44000, 51000,
    39000, 58000, 43000, 49000, 37000, 65000, 45000, 52000, 40000, 59000,
    34000, 68000, 46000, 53000, 38000, 61000, 42000, 50000, 36000, 66000,
    47000, 54000, 41000, 63000, 43000, 51000, 39000, 67000, 45000, 55000
  ],
  "bins": 12,
  "title": "公司員工月薪分佈圖",
  "x_axis_label": "月薪 (元)",
  "y_axis_label": "員工人數",
  "generate_image": true,
  "context": {
    "scenario": "general",
    "variable_name": "員工月薪",
    "analysis_purpose": "薪資結構合理性分析"
  }
}
```

### 情境 2: 咖啡店每日營業額分析
**生活情境**: 咖啡店老闆想了解每日營業額的分佈模式
**數據**: 三個月的每日營業額記錄
**目的**: 了解營業額波動模式，制定經營策略

**測試數據**:
```json
{
  "values": [
    12500, 15800, 13200, 18900, 14700, 16400, 12800, 17200, 13900, 15600,
    11900, 19200, 14200, 16800, 13500, 17800, 15100, 16200, 12300, 18500,
    13800, 15900, 14500, 17500, 12700, 18100, 14000, 16600, 13100, 17900,
    15400, 16100, 12600, 18700, 14300, 16900, 13400, 17300, 15200, 16500,
    12100, 19000, 14600, 17100, 13700, 16300, 15500, 17700, 12900, 18300
  ],
  "bins": 10,
  "title": "咖啡店每日營業額分佈",
  "x_axis_label": "每日營業額 (元)",
  "y_axis_label": "天數",
  "generate_image": true,
  "context": {
    "scenario": "general",
    "variable_name": "每日營業額",
    "analysis_purpose": "營業模式與波動分析"
  }
}
```

### 情境 3: 學生體重分佈調查
**生活情境**: 學校護理師想了解學生體重分佈，制定健康計畫
**數據**: 高中生體重測量資料
**目的**: 了解學生體重分佈，識別需要健康指導的學生群體

**測試數據**:
```json
{
  "values": [
    52.3, 58.7, 55.1, 67.2, 54.8, 61.4, 53.6, 64.9, 56.2, 59.8,
    51.7, 69.1, 57.3, 62.5, 54.2, 66.7, 58.1, 60.9, 52.8, 68.3,
    55.9, 63.4, 57.7, 65.8, 53.1, 67.9, 56.8, 61.2, 54.5, 64.1,
    58.4, 62.8, 55.5, 66.2, 57.9, 63.7, 54.1, 68.6, 56.4, 61.8,
    53.3, 69.5, 58.2, 64.3, 55.7, 67.1, 57.1, 62.1, 54.9, 65.4
  ],
  "bins": 8,
  "title": "高中生體重分佈圖",
  "x_axis_label": "體重 (kg)",
  "y_axis_label": "學生人數",
  "generate_image": true,
  "context": {
    "scenario": "general",
    "variable_name": "學生體重",
    "analysis_purpose": "健康狀況評估與指導"
  }
}
```

## 特殊分佈情境

### 情境 4: 右偏分佈 - 網站停留時間
**研究背景**: 分析網站用戶停留時間，典型的右偏分佈
**特點**: 大多數用戶停留時間短，少數用戶停留時間很長

**測試數據**:
```json
{
  "values": [
    15, 23, 18, 45, 21, 32, 19, 67, 25, 38, 16, 89, 27, 41, 20,
    125, 29, 35, 22, 156, 31, 43, 24, 178, 33, 47, 26, 198, 36,
    52, 28, 234, 39, 48, 30, 267, 42, 55, 34, 298, 44, 58, 37,
    325, 46, 61, 40, 356, 49, 64, 43, 387, 51, 67, 45, 412
  ],
  "bins": 15,
  "title": "網站用戶停留時間分佈（右偏分佈）",
  "x_axis_label": "停留時間 (秒)",
  "y_axis_label": "用戶人數",
  "generate_image": true,
  "context": {
    "scenario": "general",
    "variable_name": "網站停留時間",
    "analysis_purpose": "用戶行為模式分析",
    "distribution_type": "右偏分佈"
  }
}
```

### 情境 5: 雙峰分佈 - 混合族群分析
**研究背景**: 混合兩個不同族群的測量值，呈現雙峰分佈
**特點**: 兩個明顯的峰值，可能代表不同的子群體

**測試數據**:
```json
{
  "values": [
    35, 38, 41, 34, 39, 37, 40, 36, 42, 33, 38, 41, 35, 39, 37,
    65, 68, 71, 64, 69, 67, 70, 66, 72, 63, 68, 71, 65, 69, 67,
    36, 39, 42, 35, 40, 38, 41, 37, 43, 34, 39, 42, 36, 40, 38,
    66, 69, 72, 65, 70, 68, 71, 67, 73, 64, 69, 72, 66, 70, 68
  ],
  "bins": 12,
  "title": "混合族群測量值分佈（雙峰分佈）",
  "x_axis_label": "測量值",
  "y_axis_label": "頻率",
  "generate_image": true,
  "context": {
    "scenario": "general",
    "variable_name": "混合族群測量值",
    "analysis_purpose": "族群分類與特徵分析",
    "distribution_type": "雙峰分佈"
  }
}
```

### 情境 6: 常態分佈 - 標準化測驗分數
**研究背景**: 大型標準化測驗分數，設計為常態分佈
**特點**: 對稱的鐘型分佈，平均數約在中央

**測試數據**:
```json
{
  "values": [
    485, 512, 498, 523, 507, 491, 518, 503, 489, 525, 510, 496, 521, 506,
    492, 519, 504, 488, 526, 511, 497, 522, 508, 494, 517, 502, 490, 524,
    509, 495, 520, 505, 487, 527, 512, 498, 523, 507, 493, 516, 501, 489,
    525, 510, 496, 521, 506, 492, 518, 503, 485, 528, 513, 499, 522, 508
  ],
  "bins": 10,
  "title": "標準化測驗分數分佈（常態分佈）",
  "x_axis_label": "測驗分數",
  "y_axis_label": "考生人數",
  "generate_image": true,
  "context": {
    "scenario": "education",
    "variable_name": "標準化測驗分數",
    "analysis_purpose": "分數分佈驗證與標準化",
    "distribution_type": "常態分佈"
  }
}
```

## 預期結果

### 統計專業用戶期望看到：
- 詳細的分佈統計量（平均數、標準差、偏度、峰度）
- 常態性檢驗結果
- 百分位數資訊
- 異常值識別
- 分佈型態分析與建議
- 後續統計方法建議

### 一般用戶期望看到：
- 清晰的視覺化圖表
- 分佈特徵的簡單描述
- 數據集中趨勢說明
- 異常值的生活化解釋
- 實用的數據洞察
- 改善建議

## AI 提問範例

### 範例 1: 軟板製造厚度分析 - 白話提問
**用戶提問**: "我們軟板廠最近在做厚度控制，收集了一批基材厚度的數據，想看看這些厚度分佈是不是正常的。客戶要求厚度要在 0.045mm 到 0.055mm 之間，我們的數據如下：

0.048, 0.052, 0.049, 0.051, 0.050, 0.047, 0.053, 0.048, 0.051, 0.049, 0.052, 0.048, 0.050, 0.049, 0.051, 0.047, 0.054, 0.048, 0.052, 0.049, 0.051, 0.048, 0.050, 0.049, 0.052, 0.047, 0.053, 0.048, 0.051, 0.049, 0.050, 0.048, 0.052, 0.049, 0.051, 0.047, 0.053, 0.048, 0.050, 0.049, 0.051, 0.048, 0.052, 0.049, 0.050, 0.047, 0.054, 0.048, 0.051, 0.049

能幫我畫個圖看看這些厚度分佈怎麼樣嗎？看看有沒有超出規格的？"

**AI 回應**: 直方圖最適合看數據分佈狀況！我來幫您分析這批軟板基材厚度數據，看看分佈是否正常，以及有多少產品在客戶要求的規格範圍內。

**工具調用**:
```json
{
  "tool": "create_histogram",
  "values": [
    0.048, 0.052, 0.049, 0.051, 0.050, 0.047, 0.053, 0.048, 0.051, 0.049,
    0.052, 0.048, 0.050, 0.049, 0.051, 0.047, 0.054, 0.048, 0.052, 0.049,
    0.051, 0.048, 0.050, 0.049, 0.052, 0.047, 0.053, 0.048, 0.051, 0.049,
    0.050, 0.048, 0.052, 0.049, 0.051, 0.047, 0.053, 0.048, 0.050, 0.049,
    0.051, 0.048, 0.052, 0.049, 0.050, 0.047, 0.054, 0.048, 0.051, 0.049
  ],
  "bins": 12,
  "title": "軟板基材厚度分佈分析",
  "x_axis_label": "基材厚度 (mm)",
  "y_axis_label": "產品數量",
  "generate_image": true,
  "show_statistics": true,
  "spec_limits": [0.045, 0.055]
}
```

### 範例 2: 軟板阻抗值分析 - 白話提問
**用戶提問**: "我們軟板的阻抗測試結果出來了，理論值應該是 50 歐姆，客戶可以接受 ±5 歐姆的誤差範圍。我想看看我們的測試結果分佈如何，是不是大部分都在合格範圍內？

測試數據：48.2, 51.8, 49.7, 50.3, 50.0, 47.9, 52.1, 48.8, 50.9, 49.1, 51.2, 48.6, 50.4, 49.6, 50.8, 48.4, 51.6, 49.2, 50.7, 49.3, 51.1, 48.9, 50.5, 49.5, 51.3, 48.7, 51.9, 49.8, 50.2, 49.4, 50.6, 49.0, 51.0, 49.9, 50.1, 48.3, 51.7, 49.1, 50.9, 49.7, 50.3, 48.5, 51.5, 49.3, 50.7, 48.1, 52.3, 49.6, 50.4, 49.8

希望能用圖表清楚看出分佈狀況和合格率。"

**AI 回應**: 用直方圖來看阻抗值分佈最清楚了！我來幫您分析這批軟板的阻抗測試結果，看看分佈是否集中在目標值附近，以及合格率如何。

**工具調用**:
```json
{
  "tool": "create_histogram",
  "values": [
    48.2, 51.8, 49.7, 50.3, 50.0, 47.9, 52.1, 48.8, 50.9, 49.1,
    51.2, 48.6, 50.4, 49.6, 50.8, 48.4, 51.6, 49.2, 50.7, 49.3,
    51.1, 48.9, 50.5, 49.5, 51.3, 48.7, 51.9, 49.8, 50.2, 49.4,
    50.6, 49.0, 51.0, 49.9, 50.1, 48.3, 51.7, 49.1, 50.9, 49.7,
    50.3, 48.5, 51.5, 49.3, 50.7, 48.1, 52.3, 49.6, 50.4, 49.8
  ],
  "bins": 15,
  "title": "軟板電路阻抗值分佈分析",
  "x_axis_label": "阻抗值 (Ω)",
  "y_axis_label": "測試點數量",
  "generate_image": true,
  "show_statistics": true,
  "spec_limits": [45.0, 55.0]
}
```

## 測試指令範例

```bash
# 基本直方圖
curl -X POST http://localhost:3000/tools/stat/create-histogram \
  -H "Content-Type: application/json" \
  -d '{
    "values": [128,135,142,118,156],
    "bins": 10,
    "title": "血壓分佈圖"
  }'

# 含圖片生成的直方圖
curl -X POST http://localhost:3000/tools/stat/create-histogram \
  -H "Content-Type: application/json" \
  -d '{
    "values": [35000,42000,38000,55000],
    "bins": 8,
    "title": "薪資分佈",
    "generate_image": true,
    "image_format": "png"
  }'
```

## 分析重點

### 分佈型態識別：
- **常態分佈**: 對稱鐘型，適合參數檢定
- **右偏分佈**: 長尾向右，考慮對數轉換或非參數方法
- **左偏分佈**: 長尾向左，需要特殊處理
- **雙峰分佈**: 可能存在混合族群，需分層分析
- **均勻分佈**: 各區間頻率相近，隨機性分析

### 實用指標：
- 眾數：最常出現的值
- 中位數：中間位置的值
- 四分位距：變異程度指標
- 異常值：需要特別關注的極端值
- 分佈範圍：數據的涵蓋範圍