# Mann-Whitney U 檢定工具測試案例

## 工具概述
Mann-Whitney U 檢定（或 Wilcoxon 秩和檢定）是獨立樣本 t 檢定的非參數替代方法，用於比較兩個獨立群組的中位數是否有顯著差異，不需要假設資料符合常態分佈。

## 統計專業情境

### 情境 1: 藥物治療效果比較（偏態分佈）
**研究背景**: 比較新藥與安慰劑對疼痛緩解時間的效果，數據呈現右偏分佈
**研究設計**: 獨立樣本設計，無法滿足常態性假設
**假設**: H₀: 兩組中位數相等 vs H₁: 兩組中位數不等

**測試數據**:
```json
{
  "group1": [12, 15, 18, 22, 25, 28, 32, 35, 45, 58, 72, 89, 125, 156, 203],
  "group2": [8, 10, 12, 14, 16, 18, 20, 22, 25, 28, 30, 35, 42, 48, 65],
  "alpha": 0.05,
  "alternative": "two-sided",
  "context": {
    "scenario": "medical",
    "variable_name": "疼痛緩解時間 (分鐘)",
    "group1_name": "安慰劑組",
    "group2_name": "新藥組",
    "distribution_note": "右偏分佈，不符合常態性"
  }
}
```

### 情境 2: 心理量表分數比較
**研究背景**: 比較兩種治療方法對憂鬱量表分數的影響，量表分數為序位資料
**研究設計**: 隨機分組設計，使用 Likert 量表測量
**假設**: H₀: 兩組分數分佈相同 vs H₁: 兩組分數分佈不同

**測試數據**:
```json
{
  "group1": [42, 38, 45, 41, 39, 44, 40, 43, 37, 46, 38, 42, 41, 39, 44],
  "group2": [35, 31, 38, 34, 32, 37, 33, 36, 30, 39, 31, 35, 34, 32, 37],
  "alpha": 0.05,
  "alternative": "two-sided",
  "context": {
    "scenario": "medical",
    "variable_name": "憂鬱量表分數",
    "group1_name": "認知行為治療",
    "group2_name": "藥物治療",
    "distribution_note": "序位資料，Likert 量表"
  }
}
```

### 情境 3: 品質評分比較（小樣本）
**研究背景**: 比較兩個供應商的產品品質評分，樣本數較小
**研究設計**: 獨立樣本，小樣本情況
**假設**: H₀: 兩供應商品質評分相同 vs H₁: 兩供應商品質評分不同

**測試數據**:
```json
{
  "group1": [7.8, 8.2, 7.5, 8.9, 7.1, 8.5, 7.9, 8.3],
  "group2": [8.8, 9.1, 8.5, 9.3, 8.7, 9.0, 8.9, 9.2, 8.6],
  "alpha": 0.05,
  "alternative": "two-sided",
  "context": {
    "scenario": "quality",
    "variable_name": "品質評分 (1-10)",
    "group1_name": "供應商A",
    "group2_name": "供應商B",
    "distribution_note": "小樣本，未知分佈"
  }
}
```

## 一般用戶情境

### 情境 1: 兩家餐廳評價比較
**生活情境**: 想比較兩家餐廳在美食APP上的評分是否有差異
**數據**: 兩家餐廳最近一個月的顧客評分記錄

**測試數據**:
```json
{
  "group1": [4.2, 4.5, 3.8, 4.1, 4.3, 3.9, 4.4, 4.0, 4.2, 3.7, 4.1, 4.3, 3.8, 4.2, 4.0],
  "group2": [4.7, 4.8, 4.5, 4.9, 4.6, 4.8, 4.4, 4.7, 4.9, 4.5, 4.6, 4.8, 4.3, 4.7, 4.6],
  "alpha": 0.05,
  "alternative": "two-sided",
  "context": {
    "scenario": "general",
    "variable_name": "顧客評分 (1-5星)",
    "group1_name": "A餐廳",
    "group2_name": "B餐廳",
    "distribution_note": "評分資料，可能不符合常態分佈"
  }
}
```

### 情境 2: 兩個班級考試成績比較
**生活情境**: 比較兩個班級的數學考試成績，但成績分佈不均勻
**數據**: 兩班學生的考試成績，分佈偏態

**測試數據**:
```json
{
  "group1": [65, 70, 72, 75, 78, 80, 82, 85, 88, 90, 92, 95, 98],
  "group2": [58, 62, 68, 71, 74, 77, 80, 83, 86, 89, 91, 94, 97, 99],
  "alpha": 0.05,
  "alternative": "two-sided",
  "context": {
    "scenario": "education",
    "variable_name": "數學考試成績",
    "group1_name": "A班",
    "group2_name": "B班",
    "distribution_note": "成績分佈可能偏態"
  }
}
```

### 情境 3: 網路購物等待時間比較
**生活情境**: 比較兩個電商平台的配送時間，配送時間通常不符合常態分佈
**數據**: 兩個平台的配送天數記錄

**測試數據**:
```json
{
  "group1": [2, 3, 2, 4, 3, 5, 3, 4, 2, 6, 4, 3, 5, 7, 4, 3, 8, 5],
  "group2": [1, 2, 1, 3, 2, 2, 1, 3, 2, 4, 3, 2, 3, 1, 2, 4, 3, 2],
  "alpha": 0.05,
  "alternative": "two-sided",
  "context": {
    "scenario": "general",
    "variable_name": "配送天數",
    "group1_name": "平台A",
    "group2_name": "平台B",
    "distribution_note": "配送時間通常右偏分佈"
  }
}
```

## 單側檢定情境

### 情境 4: 新減重方法效果驗證（統計專業）
**研究背景**: 驗證新減重方法是否比傳統方法更有效
**假設**: H₀: 新方法 ≤ 傳統方法 vs H₁: 新方法 > 傳統方法

**測試數據**:
```json
{
  "group1": [2.5, 3.2, 1.8, 4.1, 3.5, 2.9, 3.8, 2.3, 4.5, 3.1, 2.7, 3.9, 2.1, 3.6, 2.8],
  "group2": [4.2, 5.1, 3.8, 5.9, 4.7, 5.3, 4.5, 5.8, 4.1, 5.5, 4.9, 5.2, 4.3, 5.7, 4.8],
  "alpha": 0.05,
  "alternative": "greater",
  "context": {
    "scenario": "medical",
    "variable_name": "體重減少 (公斤)",
    "group1_name": "傳統方法",
    "group2_name": "新方法",
    "test_direction": "新方法是否更有效"
  }
}
```

### 情境 5: 學習APP效果測試（一般用戶）
**生活情境**: 測試新的學習APP是否真的能提高學習效率
**假設**: 新APP的學習時間應該更短

**測試數據**:
```json
{
  "group1": [45, 52, 38, 61, 47, 55, 42, 58, 49, 54, 41, 56, 43, 59, 48],
  "group2": [35, 42, 28, 48, 37, 44, 32, 46, 39, 43, 31, 45, 33, 47, 38],
  "alpha": 0.05,
  "alternative": "less",
  "context": {
    "scenario": "education",
    "variable_name": "完成任務時間 (分鐘)",
    "group1_name": "傳統學習",
    "group2_name": "使用APP",
    "test_direction": "APP是否能縮短學習時間"
  }
}
```

## 預期結果

### 統計專業用戶期望看到：
- U 統計量和 Z 統計量
- 準確的 p 值（包括連續性校正）
- 效果量（r = Z/√N 或 η²）
- 秩和統計量
- 中位數及其信賴區間
- 常態性檢定結果說明
- 樣本大小適當性評估

### 一般用戶期望看到：
- 簡潔的比較結論
- 中位數比較結果
- 差異的實際意義說明
- 視覺化圖表（盒鬚圖）
- 為什麼選擇此檢定的說明
- 實用的建議

## 測試指令範例

```bash
# 雙側檢定
curl -X POST http://localhost:3000/tools/stat/perform-mann-whitney \
  -H "Content-Type: application/json" \
  -d '{
    "group1": [12,15,18,22,25],
    "group2": [8,10,12,14,16],
    "alternative": "two-sided"
  }'

# 單側檢定（group2 > group1）
curl -X POST http://localhost:3000/tools/stat/perform-mann-whitney \
  -H "Content-Type: application/json" \
  -d '{
    "group1": [2.5,3.2,1.8],
    "group2": [4.2,5.1,3.8],
    "alternative": "greater"
  }'
```

## 使用時機
- 資料不符合常態分佈
- 樣本大小較小
- 資料為序位資料或間隔資料
- 存在極端值或離群值
- 變異數不相等
- 想要更穩健的檢定方法

## 假設檢驗條件
- 兩組樣本需獨立
- 資料至少為序位尺度
- 兩組的資料分佈形狀相似（用於比較中位數）
- 隨機抽樣