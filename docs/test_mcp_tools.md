# MCP 工具調用測試指南

## 🎯 測試目標

驗證 SFDA Nexus 的 MCP 工具調用功能，特別是員工 ID 格式驗證問題的解決方案。

## 📋 可用的測試員工資料

根據 MCP Server 的測試資料，以下員工 ID 可用於測試：

### HR 工具測試用員工清單

- **A123456** - 張小明（開發部，軟體工程師）
- **A123457** - 李小華（人力資源部，人資專員）
- **A116592** - 蕭傳璋（Data Analytics，人資專員）
- **A234567** - 林美玲（Marketing，行銷專員）
- **B112233** - 陳志明（Research & Development，軟體工程師）
- **A778899** - 鄭雅婷（Research & Development，初階工程師）

## 🧪 測試案例

### 測試案例 1：基本員工資訊查詢

**輸入**: "請查詢員工 A123456 的基本資訊"
**預期**: AI 正確識別需要調用 `get_employee_info` 工具，並使用正確的員工 ID 格式

### 測試案例 2：多個員工查詢

**輸入**: "請查詢 A123456 和 A123457 兩位員工的資訊"
**預期**: AI 進行兩次工具調用，分別查詢兩位員工

### 測試案例 3：出勤記錄查詢

**輸入**: "請查詢員工 A123456 在 2024 年 12 月 的出勤記錄"
**預期**: AI 調用 `get_attendance_record` 工具，使用正確的日期格式

### 測試案例 4：薪資資訊查詢

**輸入**: "請查詢員工 A123456 在 2024-12 的薪資資訊"
**預期**: AI 調用 `get_salary_info` 工具

### 測試案例 5：部門清單查詢

**輸入**: "請列出所有部門"
**預期**: AI 調用 `get_department_list` 工具

### 測試案例 6：員工清單查詢

**輸入**: "請列出研發部門的員工"
**預期**: AI 調用 `get_employee_list` 工具

### 測試案例 7：任務管理工具

**輸入**: "請幫我創建一個任務：檢查系統日誌"
**預期**: AI 調用 `create_task` 工具

### 測試案例 8：財務查詢工具

**輸入**: "請查詢目前的預算狀況"
**預期**: AI 調用 `get_budget_status` 工具

## 🔍 格式驗證測試

### 正確格式測試

- ✅ A123456
- ✅ B123456
- ✅ Z999999

### 錯誤格式測試（應該被拒絕）

- ❌ john（純文字）
- ❌ 123456（無字母）
- ❌ AB123456（兩個字母）
- ❌ A12345（位數不足）
- ❌ a123456（小寫字母）

## 📊 驗證標準

### 1. 工具調用識別

- [ ] AI 正確識別需要調用工具的場景
- [ ] AI 選擇正確的工具名稱

### 2. 參數格式

- [ ] 員工 ID 使用正確格式 (A123456)
- [ ] 日期使用正確格式 (YYYY-MM-DD)
- [ ] 其他參數符合要求

### 3. 錯誤處理

- [ ] 無效員工 ID 格式的錯誤提示
- [ ] 不存在員工 ID 的錯誤處理
- [ ] 工具調用失敗的優雅處理

### 4. 結果呈現

- [ ] 工具執行結果正確顯示
- [ ] 錯誤信息清楚易懂
- [ ] 用戶體驗良好

## 🚀 快速測試命令

### 測試 1：基本查詢

```
請查詢員工 A123456 的基本資訊
```

### 測試 2：無效格式

```
請查詢員工 john 的基本資訊
```

### 測試 3：不存在的員工

```
請查詢員工 A999999 的基本資訊
```

## 📝 測試記錄

| 測試案例   | 狀態 | 工具調用正確 | 參數格式正確 | 結果顯示正確 | 備註 |
| ---------- | ---- | ------------ | ------------ | ------------ | ---- |
| 基本查詢   |      |              |              |              |      |
| 無效格式   |      |              |              |              |      |
| 不存在員工 |      |              |              |              |      |
| 出勤記錄   |      |              |              |              |      |
| 薪資查詢   |      |              |              |              |      |

## 🔧 故障排除

### 1. 工具調用沒有執行

- 檢查 MCP Server 是否運行在 port 8080
- 檢查後端服務是否正常啟動
- 檢查系統提示詞是否包含工具資訊

### 2. 參數格式錯誤

- 確認系統提示詞已更新
- 檢查參數說明是否包含格式要求
- 查看 AI 回應中的工具調用 JSON

### 3. 結果沒有返回

- 檢查 MCP Client 連接狀態
- 查看後端控制台日誌
- 確認員工 ID 存在於測試資料中
